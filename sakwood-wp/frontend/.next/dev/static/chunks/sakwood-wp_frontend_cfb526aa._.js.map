{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Works/Web/sakwood/sakwood-wp/frontend/lib/services/searchService.ts"],"sourcesContent":["import { API_CONFIG } from '@/lib/config/constants';\n\ninterface SearchProduct {\n  id: string;\n  name: string;\n  slug: string;\n  price?: string;\n  regularPrice?: string;\n  description?: string;\n  image?: {\n    sourceUrl: string;\n    altText?: string;\n  };\n  shortDescription?: string;\n  type?: string;\n}\n\ninterface SearchResponse {\n  products: SearchProduct[];\n  total: number;\n}\n\n/**\n * Search products using WordPress GraphQL API\n */\nexport async function searchProducts(\n  query: string,\n  lang: string = 'th'\n): Promise<SearchResponse> {\n  if (!query || query.trim().length === 0) {\n    return { products: [], total: 0 };\n  }\n\n  try {\n    let searchTerm = query.trim();\n\n    // Remove spaces for Thai searches to improve matching\n    // Thai product names often don't need spaces between characters\n    if (lang === 'th') {\n      searchTerm = searchTerm.replace(/\\s+/g, '');\n    }\n\n    // GraphQL query to search products by name, description, or short description\n    const graphqlQuery = `\n      query SearchProducts($search: String!) {\n        products(where: { search: $search }) {\n          nodes {\n            id: databaseId\n            slug\n            name\n            type\n            description\n            shortDescription(format: RENDERED)\n            ... on SimpleProduct {\n              price\n              regularPrice\n            }\n            ... on VariableProduct {\n              price\n              regularPrice\n            }\n            image {\n              sourceUrl\n              altText\n            }\n          }\n        }\n      }\n    `;\n\n    const response = await fetch(API_CONFIG.endpoint, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        query: graphqlQuery,\n        variables: {\n          search: searchTerm,\n        },\n      }),\n      next: { revalidate: 30 }, // Cache for 30 seconds\n    });\n\n    if (!response.ok) {\n      console.error('[SearchService] Failed to fetch:', response.statusText);\n      return { products: [], total: 0 };\n    }\n\n    const data = await response.json();\n    const products = data.data?.products?.nodes || [];\n\n    // Transform data to match our Product type\n    const transformedProducts: SearchProduct[] = products.map((product: any) => ({\n      id: String(product.id),\n      name: product.name,\n      slug: product.slug,\n      price: product.price || undefined,\n      regularPrice: product.regularPrice || undefined,\n      description: product.description || undefined,\n      image: product.image || undefined,\n      shortDescription: product.shortDescription || undefined,\n      type: product.type || 'simple',\n    }));\n\n    return {\n      products: transformedProducts,\n      total: transformedProducts.length,\n    };\n  } catch (error) {\n    console.error('[SearchService] Error searching products:', error);\n    return { products: [], total: 0 };\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAyBO,eAAe,eACpB,KAAa,EACb,OAAe,IAAI;IAEnB,IAAI,CAAC,SAAS,MAAM,IAAI,GAAG,MAAM,KAAK,GAAG;QACvC,OAAO;YAAE,UAAU,EAAE;YAAE,OAAO;QAAE;IAClC;IAEA,IAAI;QACF,IAAI,aAAa,MAAM,IAAI;QAE3B,sDAAsD;QACtD,gEAAgE;QAChE,IAAI,SAAS,MAAM;YACjB,aAAa,WAAW,OAAO,CAAC,QAAQ;QAC1C;QAEA,8EAA8E;QAC9E,MAAM,eAAe,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;IAyBtB,CAAC;QAED,MAAM,WAAW,MAAM,MAAM,wKAAU,CAAC,QAAQ,EAAE;YAChD,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBACnB,OAAO;gBACP,WAAW;oBACT,QAAQ;gBACV;YACF;YACA,MAAM;gBAAE,YAAY;YAAG;QACzB;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,QAAQ,KAAK,CAAC,oCAAoC,SAAS,UAAU;YACrE,OAAO;gBAAE,UAAU,EAAE;gBAAE,OAAO;YAAE;QAClC;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAChC,MAAM,WAAW,KAAK,IAAI,EAAE,UAAU,SAAS,EAAE;QAEjD,2CAA2C;QAC3C,MAAM,sBAAuC,SAAS,GAAG,CAAC,CAAC,UAAiB,CAAC;gBAC3E,IAAI,OAAO,QAAQ,EAAE;gBACrB,MAAM,QAAQ,IAAI;gBAClB,MAAM,QAAQ,IAAI;gBAClB,OAAO,QAAQ,KAAK,IAAI;gBACxB,cAAc,QAAQ,YAAY,IAAI;gBACtC,aAAa,QAAQ,WAAW,IAAI;gBACpC,OAAO,QAAQ,KAAK,IAAI;gBACxB,kBAAkB,QAAQ,gBAAgB,IAAI;gBAC9C,MAAM,QAAQ,IAAI,IAAI;YACxB,CAAC;QAED,OAAO;YACL,UAAU;YACV,OAAO,oBAAoB,MAAM;QACnC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6CAA6C;QAC3D,OAAO;YAAE,UAAU,EAAE;YAAE,OAAO;QAAE;IAClC;AACF"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///D:/Works/Web/sakwood/sakwood-wp/frontend/components/search/SearchResults.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { Search, X, Loader2 } from 'lucide-react';\nimport { searchProducts } from '@/lib/services/searchService';\nimport type { Locale } from '@/i18n-config';\nimport Link from 'next/link';\n\ninterface SearchResultProduct {\n  id: string;\n  name: string;\n  slug: string;\n  price?: string;\n  regularPrice?: string;\n  description?: string;\n  image?: {\n    sourceUrl: string;\n    altText?: string;\n  };\n}\n\ninterface SearchResultsProps {\n  lang: Locale;\n  dictionary: any;\n  searchQuery: string;\n  initialResults: {\n    products: SearchResultProduct[];\n    total: number;\n  };\n}\n\nexport function SearchResults({\n  lang,\n  dictionary,\n  searchQuery,\n  initialResults,\n}: SearchResultsProps) {\n  const router = useRouter();\n  const [query, setQuery] = useState(searchQuery);\n  const [results, setResults] = useState(initialResults);\n  const [isLoading, setIsLoading] = useState(false);\n  const [hasSearched, setHasSearched] = useState(true);\n\n  const dict = dictionary.search || {\n    title: lang === 'th' ? 'ค้นหาสินค้า' : 'Search Products',\n    search_placeholder: lang === 'th' ? 'ค้นหาชื่อสินค้า...' : 'Search products...',\n    search_button: lang === 'th' ? 'ค้นหา' : 'Search',\n    no_results: lang === 'th' ? 'ไม่พบสินค้า' : 'No products found',\n    no_results_text: lang === 'th'\n      ? 'ลอค้นหาด้วยคำค้นอื่น'\n      : 'Try searching with different keywords',\n    results_found: lang === 'th' ? 'พบ {count} สินค้า' : 'Found {count} products',\n    view_details: lang === 'th' ? 'ดูรายละเอียด' : 'View Details',\n  };\n\n  const handleSearch = async (searchTerm: string) => {\n    if (!searchTerm || searchTerm.trim().length === 0) return;\n\n    setIsLoading(true);\n    setHasSearched(true);\n\n    try {\n      const data = await searchProducts(searchTerm, lang);\n      setResults(data);\n    } catch (error) {\n      console.error('Search error:', error);\n      setResults({ products: [], total: 0 });\n    } finally {\n      setIsLoading(false);\n    }\n\n    // Update URL without full page reload\n    const params = new URLSearchParams({ q: searchTerm });\n    router.replace(`/${lang}/search?${params.toString()}`, { scroll: false });\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    handleSearch(query);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Search Header */}\n      <div className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8\">\n          <div className=\"max-w-3xl mx-auto\">\n            <h1 className=\"text-2xl sm:text-3xl font-bold text-gray-900 mb-4 sm:mb-6 text-center\">\n              {dict.title}\n            </h1>\n\n            <form onSubmit={handleSubmit} className=\"relative\">\n              <input\n                type=\"text\"\n                value={query}\n                onChange={(e) => setQuery(e.target.value)}\n                placeholder={dict.search_placeholder}\n                className=\"w-full pl-12 pr-24 py-3 sm:py-4 text-base border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition-all\"\n                autoFocus\n              />\n              <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n\n              <div className=\"absolute right-2 top-1/2 -translate-y-1/2 flex gap-2\">\n                {query && (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      setQuery('');\n                      setResults({ products: [], total: 0 });\n                      setHasSearched(false);\n                    }}\n                    className=\"p-2 text-gray-400 hover:text-gray-600 transition-colors\"\n                    aria-label=\"Clear search\"\n                  >\n                    <X className=\"w-5 h-5\" />\n                  </button>\n                )}\n\n                <button\n                  type=\"submit\"\n                  disabled={isLoading || !query.trim()}\n                  className=\"px-4 sm:px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-sm sm:text-base\"\n                >\n                  {isLoading ? (\n                    <Loader2 className=\"w-4 h-4 sm:w-5 sm:h-5 animate-spin\" />\n                  ) : (\n                    <>\n                      <Search className=\"w-4 h-4 sm:w-5 sm:h-5\" />\n                      <span className=\"hidden sm:inline\">{dict.search_button}</span>\n                    </>\n                  )}\n                </button>\n              </div>\n            </form>\n\n            {hasSearched && !isLoading && (\n              <div className=\"mt-4 text-center text-sm text-gray-600\">\n                {results.total > 0 ? (\n                  dict.results_found.replace('{count}', String(results.total))\n                ) : (\n                  dict.no_results\n                )}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Search Results */}\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8\">\n        {isLoading && (\n          <div className=\"flex justify-center items-center py-12\">\n            <Loader2 className=\"w-8 h-8 sm:w-12 sm:h-12 text-blue-600 animate-spin\" />\n          </div>\n        )}\n\n        {!isLoading && hasSearched && results.products.length > 0 && (\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6\">\n            {results.products.map((product) => (\n              <div\n                key={product.id}\n                className=\"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-shadow group\"\n              >\n                {/* Product Image */}\n                <Link href={`/${lang}/products/${product.slug}`} className=\"block\">\n                  <div className=\"relative aspect-square bg-gray-100 overflow-hidden\">\n                    {product.image?.sourceUrl ? (\n                      <img\n                        src={product.image.sourceUrl}\n                        alt={product.image.altText || product.name}\n                        className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300\"\n                      />\n                    ) : (\n                      <div className=\"w-full h-full flex items-center justify-center text-gray-300\">\n                        <svg className=\"w-16 h-16 sm:w-24 sm:h-24\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\n                        </svg>\n                      </div>\n                    )}\n                  </div>\n                </Link>\n\n                {/* Product Info */}\n                <div className=\"p-4\">\n                  <Link href={`/${lang}/products/${product.slug}`}>\n                    <h3 className=\"font-bold text-gray-900 mb-2 line-clamp-2 group-hover:text-blue-600 transition-colors text-sm sm:text-base\">\n                      {product.name}\n                    </h3>\n                  </Link>\n\n                  {product.price && (\n                    <div className=\"flex items-center justify-between mt-3\">\n                      <div className=\"flex flex-col\">\n                        <span className=\"text-lg sm:text-xl font-bold text-blue-600\">\n                          {product.price}\n                        </span>\n                        {product.regularPrice && product.regularPrice !== product.price && (\n                          <span className=\"text-xs sm:text-sm text-gray-400 line-through\">\n                            {product.regularPrice}\n                          </span>\n                        )}\n                      </div>\n                    </div>\n                  )}\n\n                  <Link\n                    href={`/${lang}/products/${product.slug}`}\n                    className=\"mt-3 sm:mt-4 block w-full text-center px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-semibold\"\n                  >\n                    {dict.view_details}\n                  </Link>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n\n        {!isLoading && hasSearched && results.products.length === 0 && (\n          <div className=\"text-center py-12 sm:py-16\">\n            <div className=\"inline-flex items-center justify-center w-20 h-20 sm:w-24 sm:h-24 bg-gray-100 rounded-full mb-4 sm:mb-6\">\n              <Search className=\"w-10 h-10 sm:w-12 sm:h-12 text-gray-400\" />\n            </div>\n            <h3 className=\"text-xl sm:text-2xl font-bold text-gray-700 mb-2\">\n              {dict.no_results}\n            </h3>\n            <p className=\"text-gray-500 text-sm sm:text-base mb-4 sm:mb-6\">\n              {dict.no_results_text}\n            </p>\n            <p className=\"text-sm text-gray-600\">\n              {lang === 'th' ? 'คำค้นที่ค้นหา: ' : 'Search query: '} <strong>\"{query}\"</strong>\n            </p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}