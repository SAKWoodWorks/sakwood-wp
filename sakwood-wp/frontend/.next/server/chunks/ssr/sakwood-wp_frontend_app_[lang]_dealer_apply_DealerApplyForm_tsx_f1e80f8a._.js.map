{"version":3,"sources":["../../../../../../sakwood-wp/frontend/app/%5Blang%5D/dealer/apply/DealerApplyForm.tsx","../../../../../../sakwood-wp/frontend/lib/services/dealerApplicationService.ts"],"sourcesContent":["'use client';\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport type { Locale } from '@/i18n-config';\nimport { Breadcrumbs } from '@/components/layout/Breadcrumbs';\nimport { Button } from '@/components/ui';\nimport { useAuth } from '@/lib/context/AuthContext';\nimport { getDealerTiers, type DealerTierInfo } from '@/lib/services/dealerService';\nimport { getThaiProvinces, submitDealerApplication, validateDealerApplication } from '@/lib/services/dealerApplicationService';\nimport type { Dictionary } from '@/lib/types/dictionary';\n\ninterface DealerApplyPageProps {\n  lang: Locale;\n  dictionary: Dictionary;\n}\n\nexport function DealerApplyForm({ lang, dictionary }: DealerApplyPageProps) {\n  const { user, token, isWholesale, isDealer, applyForDealer } = useAuth();\n  const router = useRouter();\n  const [tiers, setTiers] = useState<DealerTierInfo[]>([]);\n  const [provinces] = useState<string[]>(getThaiProvinces());\n\n  const [formData, setFormData] = useState({\n    requestedTier: '',\n    storageFacility: '',\n    deliveryVehicles: '',\n    salesCapacity: '',\n    dealerExperience: '',\n    requestedTerritories: [] as string[],\n    tradeReferences: [] as Array<{ company: string; contact: string; relationship: string }>,\n    businessReferences: [] as Array<{ company: string; contact: string; accountValue: string }>,\n  });\n\n  const [error, setError] = useState('');\n  const [success, setSuccess] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const [mounted, setMounted] = useState(false);\n\n  useEffect(() => {\n    setMounted(true);\n    async function loadData() {\n      const tiersResult = await getDealerTiers();\n      if (tiersResult.success && tiersResult.data) {\n        setTiers(tiersResult.data);\n      }\n    }\n    loadData();\n  }, [lang]);\n\n  // Redirect if already a dealer\n  useEffect(() => {\n    if (mounted && isDealer) {\n      router.push(`/${lang}/dealer/status`);\n    }\n  }, [mounted, isDealer, lang, router]);\n\n  // Handle redirect after successful submission\n  useEffect(() => {\n    if (success) {\n      const timer = setTimeout(() => {\n        router.push(`/${lang}/dealer/status`);\n      }, 2000);\n\n      return () => clearTimeout(timer);\n    }\n  }, [success, lang, router]);\n\n  const { dealer, common } = dictionary;\n\n  // Show access requirements if not wholesale\n  if (!user) {\n    return (\n      <>\n        <Breadcrumbs\n          items={[\n            { name: common.home, href: `/${lang}` },\n            { name: dealer.page_title, href: `/${lang}/dealer/apply` },\n          ]}\n          lang={lang}\n        />\n        <div className=\"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n          <div className=\"max-w-3xl mx-auto\">\n            <div className=\"bg-white rounded-lg shadow-md p-8\">\n              <div className=\"text-center mb-6\">\n                <svg className=\"mx-auto h-12 w-12 text-yellow-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n                </svg>\n                <h2 className=\"mt-4 text-2xl font-bold text-gray-900\">\n                  Authentication Required\n                </h2>\n              </div>\n\n              <div className=\"space-y-4\">\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4\">\n                  <h3 className=\"font-semibold text-blue-900 mb-2\">üîí Dealer Application Requirements</h3>\n                  <p className=\"text-blue-800 text-sm mb-3\">\n                    To apply for dealer status, you must first be an <strong>active wholesale customer</strong>.\n                  </p>\n                  <div className=\"bg-white rounded p-3 text-sm text-blue-900\">\n                    <p className=\"font-medium mb-2\">Required Steps:</p>\n                    <ol className=\"list-decimal list-inside space-y-1\">\n                      <li>Register an account</li>\n                      <li>Apply for wholesale status</li>\n                      <li>Wait for admin approval</li>\n                      <li>Then apply for dealer status</li>\n                    </ol>\n                  </div>\n                </div>\n\n                <div className=\"flex gap-4\">\n                  <Link href={`/${lang}/register`} className=\"flex-1\">\n                    <Button variant=\"primary\" size=\"lg\" className=\"w-full\">\n                      Register Account\n                    </Button>\n                  </Link>\n                  <Link href={`/${lang}/login`} className=\"flex-1\">\n                    <Button variant=\"secondary\" size=\"lg\" className=\"w-full\">\n                      Login\n                    </Button>\n                  </Link>\n                </div>\n\n                <Link href={`/${lang}/account`} className=\"block text-center text-blue-600 hover:text-blue-800\">\n                  ‚Üê Back to Home\n                </Link>\n              </div>\n            </div>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  // Show access requirements if not wholesale\n  if (!isWholesale) {\n    return (\n      <>\n        <Breadcrumbs\n          items={[\n            { name: common.home, href: `/${lang}` },\n            { name: dealer.page_title, href: `/${lang}/dealer/apply` },\n          ]}\n          lang={lang}\n        />\n        <div className=\"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n          <div className=\"max-w-3xl mx-auto\">\n            <div className=\"bg-white rounded-lg shadow-md p-8\">\n              <div className=\"text-center mb-6\">\n                <svg className=\"mx-auto h-12 w-12 text-yellow-500\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z\" />\n                </svg>\n                <h2 className=\"mt-4 text-2xl font-bold text-gray-900\">\n                  Wholesale Status Required\n                </h2>\n              </div>\n\n              <div className=\"space-y-4\">\n                <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\n                  <h3 className=\"font-semibold text-yellow-900 mb-2\">üìã Dealer Application Requirements</h3>\n                  <p className=\"text-yellow-800 text-sm mb-3\">\n                    Dear <strong>{user.displayName || user.firstName}</strong>, you must first be an <strong>active wholesale customer</strong> before applying for dealer status.\n                  </p>\n                  <div className=\"bg-white rounded p-3 text-sm text-yellow-900\">\n                    <p className=\"font-medium mb-2\">Your Path to Dealer Status:</p>\n                    <ol className=\"list-decimal list-inside space-y-1\">\n                      <li>‚úÖ Register account <strong>(Complete)</strong></li>\n                      <li className=\"text-orange-600 font-medium\">‚è≥ Apply for wholesale status</li>\n                      <li>‚è≥ Wait for wholesale approval</li>\n                      <li>‚è≥ Apply for dealer status</li>\n                    </ol>\n                  </div>\n                </div>\n\n                <Link href={`/${lang}/account`} className=\"block\">\n                  <Button variant=\"primary\" size=\"lg\" className=\"w-full\">\n                    Apply for Wholesale Status\n                  </Button>\n                </Link>\n\n                <Link href={`/${lang}`} className=\"block text-center text-blue-600 hover:text-blue-800\">\n                  ‚Üê Back to Home\n                </Link>\n              </div>\n            </div>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError('');\n\n    // Validation\n    if (!formData.requestedTier) {\n      setError(dealer.select_tier);\n      return;\n    }\n\n    if (formData.requestedTerritories.length === 0) {\n      setError('Please select at least one territory');\n      return;\n    }\n\n    const validation = validateDealerApplication({\n      requestedTier: parseInt(formData.requestedTier),\n      storageFacility: formData.storageFacility,\n      deliveryVehicles: formData.deliveryVehicles,\n      salesCapacity: formData.salesCapacity,\n      dealerExperience: formData.dealerExperience,\n      requestedTerritories: formData.requestedTerritories,\n      tradeReferences: formData.tradeReferences,\n      businessReferences: formData.businessReferences,\n    });\n\n    if (!validation.valid) {\n      setError(validation.errors.join(', '));\n      return;\n    }\n\n    setIsLoading(true);\n\n    try {\n      const result = await applyForDealer({\n        requestedTier: parseInt(formData.requestedTier),\n        storageFacility: formData.storageFacility,\n        deliveryVehicles: formData.deliveryVehicles,\n        salesCapacity: formData.salesCapacity,\n        dealerExperience: formData.dealerExperience,\n        requestedTerritories: formData.requestedTerritories,\n        tradeReferences: formData.tradeReferences,\n        businessReferences: formData.businessReferences,\n      });\n\n      if (result.success) {\n        // Save application data to localStorage for status page\n        const applicationData = {\n          status: 'pending' as const,\n          applicationId: result.applicationId || `DLR-${Date.now()}`,\n          submittedDate: new Date().toISOString(),\n          businessName: user.businessName || user.displayName,\n        };\n\n        try {\n          localStorage.setItem('dealer_application', JSON.stringify(applicationData));\n        } catch (error) {\n          console.error('Failed to save application data:', error);\n          // Continue anyway - this isn't critical\n        }\n\n        setSuccess(true);\n        // Redirect to status page after 2 seconds\n      } else {\n        setError(result.error || dealer.error_application_pending);\n        setIsLoading(false);\n      }\n    } catch (err) {\n      setError('An unexpected error occurred. Please try again.');\n      setIsLoading(false);\n    }\n  };\n\n  const addTradeReference = () => {\n    setFormData({\n      ...formData,\n      tradeReferences: [...formData.tradeReferences, { company: '', contact: '', relationship: '' }],\n    });\n  };\n\n  const removeTradeReference = (index: number) => {\n    setFormData({\n      ...formData,\n      tradeReferences: formData.tradeReferences.filter((_, i) => i !== index),\n    });\n  };\n\n  const updateTradeReference = (index: number, field: string, value: string) => {\n    const updated = [...formData.tradeReferences];\n    updated[index] = { ...updated[index], [field]: value };\n    setFormData({ ...formData, tradeReferences: updated });\n  };\n\n  const addBusinessReference = () => {\n    setFormData({\n      ...formData,\n      businessReferences: [...formData.businessReferences, { company: '', contact: '', accountValue: '' }],\n    });\n  };\n\n  const removeBusinessReference = (index: number) => {\n    setFormData({\n      ...formData,\n      businessReferences: formData.businessReferences.filter((_, i) => i !== index),\n    });\n  };\n\n  const updateBusinessReference = (index: number, field: string, value: string) => {\n    const updated = [...formData.businessReferences];\n    updated[index] = { ...updated[index], [field]: value };\n    setFormData({ ...formData, businessReferences: updated });\n  };\n  const breadcrumbItems = [\n    { name: common.home, href: `/${lang}` },\n    { name: dealer.page_title, href: `/${lang}/dealer/apply` }\n  ];\n\n  if (success) {\n    return (\n      <>\n        <Breadcrumbs items={breadcrumbItems} lang={lang} />\n        <div className=\"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n          <div className=\"max-w-2xl mx-auto\">\n            <div className=\"bg-white rounded-lg shadow-md p-8 text-center\">\n              <div className=\"inline-flex items-center justify-center w-16 h-16 bg-green-100 text-green-600 rounded-full mb-4\">\n                <svg className=\"w-8 h-8\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\n                </svg>\n              </div>\n              <h2 className=\"text-2xl font-bold text-gray-900 mb-4\">\n                {dealer.success_title}\n              </h2>\n              <p className=\"text-gray-600 mb-6\">\n                {dealer.success_message}\n              </p>\n              <p className=\"text-sm text-gray-500\">\n                Redirecting to status page...\n              </p>\n            </div>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  return (\n    <>\n      <Breadcrumbs items={breadcrumbItems} lang={lang} />\n\n      <div className=\"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n        <div className=\"max-w-4xl mx-auto\">\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\n              {dealer.application_title}\n            </h1>\n            <p className=\"text-gray-600\">\n              {dealer.application_subtitle}\n            </p>\n          </div>\n\n          {error && (\n            <div\n              className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded mb-6\"\n              role=\"alert\"\n              aria-live=\"assertive\"\n            >\n              {error}\n            </div>\n          )}\n\n          <form onSubmit={handleSubmit} className=\"bg-white rounded-lg shadow-md p-8 space-y-8\">\n            {/* Tier Selection */}\n            <div>\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-4 pb-2 border-b\">\n                {dealer.tier_selection}\n              </h2>\n\n              <div className=\"space-y-4\">\n                {tiers.map((tier) => (\n                  <label\n                    key={tier.id}\n                    className={`block p-4 border rounded-lg cursor-pointer transition-all ${\n                      formData.requestedTier === tier.id.toString()\n                        ? 'border-blue-500 bg-blue-50'\n                        : 'border-gray-300 hover:border-gray-400'\n                    }`}\n                  >\n                    <div className=\"flex items-start\">\n                      <input\n                        type=\"radio\"\n                        name=\"tier\"\n                        value={tier.id}\n                        checked={formData.requestedTier === tier.id.toString()}\n                        onChange={(e) => setFormData({ ...formData, requestedTier: e.target.value })}\n                        className=\"mt-1 mr-3\"\n                      />\n                      <div className=\"flex-1\">\n                        <div className=\"font-semibold text-gray-900 mb-1\">\n                          {tier.tier_name === 'silver' && dealer.tier_silver}\n                          {tier.tier_name === 'gold' && dealer.tier_gold}\n                          {tier.tier_name === 'platinum' && dealer.tier_platinum}\n                        </div>\n                        <div className=\"text-sm text-gray-600 mb-2\">\n                          {tier.tier_name === 'silver' && dealer.tier_silver_desc}\n                          {tier.tier_name === 'gold' && dealer.tier_gold_desc}\n                          {tier.tier_name === 'platinum' && dealer.tier_platinum_desc}\n                        </div>\n                        <div className=\"text-xs text-gray-500\">\n                          {dealer.requirements_list}:\n                        </div>\n                        <ul className=\"text-xs text-gray-600 mt-1 space-y-1\">\n                          {(() => {\n                            try {\n                              const reqs = JSON.parse(tier.requirements || '[]');\n                              return reqs.map((req: string, idx: number) => (\n                                <li key={idx} className=\"flex items-start\">\n                                  <span className=\"mr-1\">‚Ä¢</span>\n                                  <span>{req}</span>\n                                </li>\n                              ));\n                            } catch (error) {\n                              console.error('Failed to parse requirements:', error);\n                              return <li className=\"text-red-600\">Requirements unavailable</li>;\n                            }\n                          })()}\n                        </ul>\n                      </div>\n                    </div>\n                  </label>\n                ))}\n              </div>\n            </div>\n\n            {/* Dealer Requirements */}\n            <div>\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-4 pb-2 border-b\">\n                {dealer.dealer_requirements}\n              </h2>\n\n              <div className=\"space-y-4\">\n                {/* Storage Facility */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {dealer.storage_facility} *\n                  </label>\n                  <textarea\n                    required\n                    rows={3}\n                    value={formData.storageFacility}\n                    onChange={(e) => setFormData({ ...formData, storageFacility: e.target.value })}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-400\"\n                    placeholder={dealer.storage_facility_placeholder}\n                  />\n                </div>\n\n                {/* Delivery Vehicles */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {dealer.delivery_vehicles} *\n                  </label>\n                  <textarea\n                    required\n                    rows={3}\n                    value={formData.deliveryVehicles}\n                    onChange={(e) => setFormData({ ...formData, deliveryVehicles: e.target.value })}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-400\"\n                    placeholder={dealer.delivery_vehicles_placeholder}\n                  />\n                </div>\n\n                {/* Sales Capacity */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {dealer.sales_capacity} *\n                  </label>\n                  <select\n                    required\n                    value={formData.salesCapacity}\n                    onChange={(e) => setFormData({ ...formData, salesCapacity: e.target.value })}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-400\"\n                  >\n                    <option value=\"\">{dealer.sales_capacity_placeholder}</option>\n                    <option value=\"10k\">{dealer.capacity_10k}</option>\n                    <option value=\"50k\">{dealer.capacity_50k}</option>\n                    <option value=\"100k\">{dealer.capacity_100k}</option>\n                    <option value=\"500k\">{dealer.capacity_500k}</option>\n                    <option value=\"1m\">{dealer.capacity_1m}</option>\n                  </select>\n                </div>\n\n                {/* Dealer Experience */}\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                    {dealer.dealer_experience} *\n                  </label>\n                  <textarea\n                    required\n                    rows={4}\n                    value={formData.dealerExperience}\n                    onChange={(e) => setFormData({ ...formData, dealerExperience: e.target.value })}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 placeholder:text-gray-400\"\n                    placeholder={dealer.dealer_experience_placeholder}\n                  />\n                </div>\n              </div>\n            </div>\n\n            {/* Territory Request */}\n            <div>\n              <h2 className=\"text-xl font-semibold text-gray-900 mb-4 pb-2 border-b\">\n                {dealer.territory_request}\n              </h2>\n\n              <div className=\"space-y-4\">\n                <p className=\"text-sm text-gray-600 mb-2\">\n                  {dealer.select_provinces}\n                </p>\n\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-2 max-h-64 overflow-y-auto border p-4 rounded\">\n                  {provinces.map((province) => (\n                    <label key={province} className=\"flex items-center space-x-2 text-sm\">\n                      <input\n                        type=\"checkbox\"\n                        checked={formData.requestedTerritories.includes(province)}\n                        onChange={(e) => {\n                          if (e.target.checked) {\n                            setFormData({\n                              ...formData,\n                              requestedTerritories: [...formData.requestedTerritories, province],\n                            });\n                          } else {\n                            setFormData({\n                              ...formData,\n                              requestedTerritories: formData.requestedTerritories.filter((p) => p !== province),\n                            });\n                          }\n                        }}\n                        className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n                      />\n                      <span className=\"text-gray-900\">{province}</span>\n                    </label>\n                  ))}\n                </div>\n\n                <p className=\"text-xs text-gray-500\">\n                  Selected: {formData.requestedTerritories.length} provinces\n                </p>\n              </div>\n            </div>\n\n            {/* References - Optional */}\n            {formData.requestedTier && parseInt(formData.requestedTier) >= 2 && (\n              <div>\n                <h2 className=\"text-xl font-semibold text-gray-900 mb-4 pb-2 border-b\">\n                  {dealer.references}\n                </h2>\n\n                {/* Trade References */}\n                <div className=\"mb-6\">\n                  <div className=\"flex items-center justify-between mb-2\">\n                    <label className=\"block text-sm font-medium text-gray-700\">\n                      {dealer.trade_references}\n                    </label>\n                    <button\n                      type=\"button\"\n                      onClick={addTradeReference}\n                      className=\"text-sm text-blue-600 hover:text-blue-800\"\n                    >\n                      {dealer.add_reference}\n                    </button>\n                  </div>\n\n                  {formData.tradeReferences.map((ref, index) => (\n                    <div key={index} className=\"border p-4 rounded mb-2 space-y-2\">\n                      <div className=\"flex justify-between items-start\">\n                        <span className=\"text-sm font-medium text-gray-700\">\n                          {dealer.references} {index + 1}\n                        </span>\n                        <button\n                          type=\"button\"\n                          onClick={() => removeTradeReference(index)}\n                          className=\"text-red-600 hover:text-red-800 text-sm\"\n                        >\n                          {dealer.remove_reference}\n                        </button>\n                      </div>\n\n                      <input\n                        type=\"text\"\n                        value={ref.company}\n                        onChange={(e) => updateTradeReference(index, 'company', e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900\"\n                        placeholder={dealer.company}\n                      />\n                      <input\n                        type=\"text\"\n                        value={ref.contact}\n                        onChange={(e) => updateTradeReference(index, 'contact', e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900\"\n                        placeholder={dealer.contact}\n                      />\n                      <input\n                        type=\"text\"\n                        value={ref.relationship}\n                        onChange={(e) => updateTradeReference(index, 'relationship', e.target.value)}\n                        className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900\"\n                        placeholder={dealer.relationship}\n                      />\n                    </div>\n                  ))}\n                </div>\n\n                {/* Business References - Platinum Only */}\n                {formData.requestedTier === '3' && (\n                  <div>\n                    <div className=\"flex items-center justify-between mb-2\">\n                      <label className=\"block text-sm font-medium text-gray-700\">\n                        {dealer.business_references}\n                      </label>\n                      <button\n                        type=\"button\"\n                        onClick={addBusinessReference}\n                        className=\"text-sm text-blue-600 hover:text-blue-800\"\n                      >\n                        {dealer.add_reference}\n                      </button>\n                    </div>\n\n                    {formData.businessReferences.map((ref, index) => (\n                      <div key={index} className=\"border p-4 rounded mb-2 space-y-2\">\n                        <div className=\"flex justify-between items-start\">\n                          <span className=\"text-sm font-medium text-gray-700\">\n                            {dealer.references} {index + 1}\n                          </span>\n                          <button\n                            type=\"button\"\n                            onClick={() => removeBusinessReference(index)}\n                            className=\"text-red-600 hover:text-red-800 text-sm\"\n                          >\n                            {dealer.remove_reference}\n                          </button>\n                        </div>\n\n                        <input\n                          type=\"text\"\n                          value={ref.company}\n                          onChange={(e) => updateBusinessReference(index, 'company', e.target.value)}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900\"\n                          placeholder={dealer.company}\n                        />\n                        <input\n                          type=\"text\"\n                          value={ref.contact}\n                          onChange={(e) => updateBusinessReference(index, 'contact', e.target.value)}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900\"\n                          placeholder={dealer.contact}\n                        />\n                        <input\n                          type=\"text\"\n                          value={ref.accountValue}\n                          onChange={(e) => updateBusinessReference(index, 'accountValue', e.target.value)}\n                          className=\"w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900\"\n                          placeholder={dealer.account_value}\n                        />\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n\n            {/* Submit Button */}\n            <div className=\"flex gap-4\">\n              <Button\n                variant=\"primary\"\n                size=\"lg\"\n                type=\"submit\"\n                disabled={isLoading}\n                className=\"flex-1\"\n              >\n                {isLoading ? dealer.submitting : dealer.submit_application}\n              </Button>\n              <Link href={`/${lang}/account`} className=\"flex-1\">\n                <Button variant=\"secondary\" size=\"lg\" type=\"button\" disabled={isLoading} className=\"w-full\">\n                  Cancel\n                </Button>\n              </Link>\n            </div>\n          </form>\n        </div>\n      </div>\n    </>\n  );\n}\n","/**\n * Dealer Application Service\n * Handles dealer application submissions\n */\n\nimport { DealerApplicationRequest, DealerApplication } from './dealerService';\n\nconst WORDPRESS_API_URL = process.env.NEXT_PUBLIC_WORDPRESS_API_URL || 'http://localhost:8006/wp-json/sakwood/v1';\n\n/**\n * Submit a dealer application\n */\nexport async function submitDealerApplication(\n  applicationData: DealerApplicationRequest,\n  token?: string\n): Promise<{ success: boolean; applicationId?: string; error?: string }> {\n  try {\n    const headers: HeadersInit = {\n      'Content-Type': 'application/json',\n    };\n\n    if (token) {\n      headers['Authorization'] = `Bearer ${token}`;\n    }\n\n    const response = await fetch(`${WORDPRESS_API_URL}/dealer/apply`, {\n      method: 'POST',\n      headers,\n      body: JSON.stringify(applicationData),\n      cache: 'no-store',\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      return { success: false, error: data.message || data.error || 'Failed to submit application' };\n    }\n\n    return { success: true, applicationId: data.applicationId };\n  } catch (error) {\n    return { success: false, error: 'Failed to submit application' };\n  }\n}\n\n/**\n * Parse sales capacity string to numeric value\n * Handles formats like \"10k\", \"50k\", \"100k\", \"500k\", \"1m\"\n */\nfunction parseSalesCapacity(capacity: string): number {\n  const lower = capacity.toLowerCase().trim();\n\n  if (lower.endsWith('k')) {\n    return parseFloat(lower.replace('k', '')) * 1000;\n  } else if (lower.endsWith('m')) {\n    return parseFloat(lower.replace('m', '')) * 1000000;\n  } else {\n    return parseFloat(lower);\n  }\n}\n\n/**\n * Validate dealer application data before submission\n */\nexport function validateDealerApplication(data: DealerApplicationRequest): { valid: boolean; errors: string[] } {\n  const errors: string[] = [];\n\n  // Required fields\n  if (!data.requestedTier) {\n    errors.push('Tier selection is required');\n  }\n\n  if (!data.storageFacility || data.storageFacility.trim().length < 20) {\n    errors.push('Storage facility details must be at least 20 characters');\n  }\n\n  if (!data.deliveryVehicles || data.deliveryVehicles.trim().length < 20) {\n    errors.push('Delivery vehicles description must be at least 20 characters');\n  }\n\n  if (!data.salesCapacity) {\n    errors.push('Sales capacity estimate is required');\n  }\n\n  if (!data.dealerExperience || data.dealerExperience.trim().length < 30) {\n    errors.push('Dealer experience must be at least 30 characters');\n  }\n\n  if (!data.requestedTerritories || data.requestedTerritories.length === 0) {\n    errors.push('At least one territory must be requested');\n  }\n\n  // Tier-specific validations\n  if (data.requestedTier === 2 || data.requestedTier === 3) { // Gold or Platinum\n    if (!data.tradeReferences || data.tradeReferences.length < 2) {\n      errors.push('At least 2 trade references required for Gold/Platinum tier');\n    }\n  }\n\n  if (data.requestedTier === 3) { // Platinum\n    if (!data.businessReferences || data.businessReferences.length < 3) {\n      errors.push('At least 3 business references required for Platinum tier');\n    }\n\n    // Check sales capacity for Platinum (parse \"500k\", \"1m\" formats)\n    const capacityValue = parseSalesCapacity(data.salesCapacity);\n    if (isNaN(capacityValue) || capacityValue < 500000) {\n      errors.push('Monthly sales capacity must be at least 500,000 THB for Platinum tier');\n    }\n  }\n\n  return {\n    valid: errors.length === 0,\n    errors,\n  };\n}\n\n/**\n * Format trade references for API submission\n */\nexport function formatTradeReferences(references: {\n  company: string;\n  contact: string;\n  relationship: string;\n}[]): string {\n  return JSON.stringify(references);\n}\n\n/**\n * Format business references for API submission\n */\nexport function formatBusinessReferences(references: {\n  company: string;\n  contact: string;\n  accountValue: string;\n}[]): string {\n  return JSON.stringify(references);\n}\n\n/**\n * Get dealer tier requirements for display\n */\nexport interface TierRequirements {\n  tierId: number;\n  tierName: string;\n  minOrderAmount: number;\n  minOrderQuantity: number;\n  requirements: string[];\n  canApply: boolean;\n  reason?: string;\n}\n\nexport async function checkTierEligibility(\n  wholesaleStatus: string,\n  wholesaleOrderCount: number,\n  wholesaleTotalSpent: number\n): Promise<TierRequirements[]> {\n  // This would typically come from an API endpoint, but for now we'll calculate client-side\n  const tiers: TierRequirements[] = [\n    {\n      tierId: 1,\n      tierName: 'Silver',\n      minOrderAmount: 50000,\n      minOrderQuantity: 50,\n      requirements: [\n        'Active wholesale customer',\n        'Minimum 1 year in business',\n        'Storage facility proof',\n        '2 trade references',\n      ],\n      canApply: wholesaleStatus === 'active',\n      reason: wholesaleStatus !== 'active' ? 'Must be an active wholesale customer' : undefined,\n    },\n    {\n      tierId: 2,\n      tierName: 'Gold',\n      minOrderAmount: 100000,\n      minOrderQuantity: 100,\n      requirements: [\n        'Active wholesale customer for 6+ months',\n        'Minimum 2 years in business',\n        'Storage facility >100 sqm',\n        '5+ trade references',\n        'Monthly sales capacity 100k+ THB',\n      ],\n      canApply: wholesaleStatus === 'active' && wholesaleOrderCount >= 5,\n      reason: wholesaleOrderCount < 5 ? 'Must have at least 5 wholesale orders' : undefined,\n    },\n    {\n      tierId: 3,\n      tierName: 'Platinum',\n      minOrderAmount: 200000,\n      minOrderQuantity: 200,\n      requirements: [\n        'Active wholesale customer for 12+ months',\n        'Minimum 3 years in business',\n        'Large storage facility >200 sqm',\n        '10+ trade references',\n        'Monthly sales capacity 500k+ THB',\n        'Delivery fleet documentation',\n      ],\n      canApply: wholesaleStatus === 'active' && wholesaleOrderCount >= 10 && wholesaleTotalSpent >= 500000,\n      reason:\n        wholesaleOrderCount < 10\n          ? 'Must have at least 10 wholesale orders'\n          : wholesaleTotalSpent < 500000\n          ? 'Must have spent at least 500,000 THB on wholesale orders'\n          : undefined,\n    },\n  ];\n\n  return tiers;\n}\n\n/**\n * Calculate estimated discount based on tier\n */\nexport function getTierDiscount(tierId: number): number {\n  const discounts: { [key: number]: number } = {\n    1: 20, // Silver\n    2: 25, // Gold\n    3: 30, // Platinum\n  };\n\n  return discounts[tierId] || 0;\n}\n\n/**\n * Get Thai provinces list for territory selection\n */\nexport function getThaiProvinces(): string[] {\n  return [\n    'Bangkok',\n    'Pathumtani',\n    'Nonthaburi',\n    'Samut Prakan',\n    'Nakhon Pathom',\n    'Samut Sakhon',\n    'Phra Nakhon Si Ayutthaya',\n    'Ang Thong',\n    'Lopburi',\n    'Saraburi',\n    'Sing Buri',\n    'Chai Nat',\n    'Suphan Buri',\n    'Kanchanaburi',\n    'Ratchaburi',\n    'Phetchaburi',\n    'Prachuap Khiri Khan',\n    'Chonburi',\n    'Rayong',\n    'Chanthaburi',\n    'Trat',\n    'Chachoengsao',\n    'Prachinburi',\n    'Sa Kaeo',\n    'Nakhon Nayok',\n    'Kamphaeng Phet',\n    'Tak',\n    'Uthai Thani',\n    'Nakhon Sawan',\n    'Phichit',\n    'Phitsanulok',\n    'Phichai',\n    'Phetchabun',\n    'Chiang Mai',\n    'Lamphun',\n    'Lampang',\n    'Uttaradit',\n    'Phrae',\n    'Nan',\n    'Phayao',\n    'Chiang Rai',\n    'Mae Hong Son',\n    'Nakhon Ratchasima',\n    'Buri Ram',\n    'Surin',\n    'Sisaket',\n    'Ubon Ratchathani',\n    'Yasothon',\n    'Chaiyaphum',\n    'Amnat Charoen',\n    'Nong Bua Lamphu',\n    'Khon Kaen',\n    'Udon Thani',\n    'Loei',\n    'Nong Khai',\n    'Maha Sarakham',\n    'Roi Et',\n    'Kalasin',\n    'Sakon Nakhon',\n    'Nakhon Phanom',\n    'Mukdahan',\n    'Chumphon',\n    'Ranong',\n    'Surat Thani',\n    'Phangnga',\n    'Phuket',\n    'Krabi',\n    'Phatthalung',\n    'Trang',\n    'Satun',\n    'Songkhla',\n    'Yala',\n    'Narathiwat',\n    'Pattani',\n    'Nakhon Si Thammarat',\n  ];\n}\n"],"names":[],"mappings":"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"}